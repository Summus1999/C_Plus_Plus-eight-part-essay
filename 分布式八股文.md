# 分布式八股文

## 分布式算法有无了解？

- Paxos：在异步网络中实现多数派共识，容忍节点故障（非拜占庭）。
- Raft：将共识问题拆解为：Leader选举 + 日志复制 + 安全性保证
- ZAB：选择ZXID最大的节点为Leader（ZXID=epoch + 计数器）。Leader生成事务 → 分配ZXID → 广播PROPOSAL->收到多数ACK → 发送COMMIT提交
- PBFT：当主节点疑似故障时，副节点发起视图切换协议。所有消息附带数字签名（防篡改）。防止恶意节点耗尽序列号空间。

## 分布式算法的好处有哪些？

- 并行计算加速处理：分布式算法将大型任务分解为多个子任务，分配到不同节点并行执行，极大缩短计算时间。例如在推荐系统、科学计算等场景中，处理TB/PB级数据时，分布式并行计算效率远超单机系统。
- 水平灵活扩展能适应业务增长：分布式算法天然支持通过添加节点横向扩展系统能力，无需重构核心逻辑。例如电商平台在流量激增时，可快速扩容服务器集群以应对高并发请求
- 故障自动恢复，去中心化抗灾：分布式算法内置冗余机制（如数据副本、心跳检测），部分节点故障时任务自动迁移至健康节点。例如HDFS默认3副本存储，确保数据不丢失；Raft算法通过Leader选举实现服务无缝切换
- 整合闲置资源，降低硬件成本：分布式算法可聚合分散的算力（如边缘设备、个人电脑），形成虚拟计算池。
- 支持复杂一致性模型，实现隐私保护设计：符合强一致性要求，联邦学习等算法允许数据本地处理，仅共享模型参数，避免敏感数据泄露，符合GDPR等合规要求。

## 两将军问题的结论是什么？

两将军问题是分布式系统领域的经典思想实验，揭示了在不可靠通信环境下达成绝对共识的理论不可行性。
结论是不可能实现绝对的可靠，只能实现相对可靠。通过超时重传、​霰弹打鸟和定时重传机制实现尽量的可靠通信。

## 分布式系统中如何产生⼀个唯⼀ID?

- UUID（通用唯一标识符）：UUID是一种128位的数字标识符，它具有极高的唯一性。UUID的生成算法设计得足够复杂，以确保在不同的节点上生成的UUID几乎不可能发生冲突。在许多编程语言和库中都有生成UUID的函数。例如，在C++中，可以使用Boost.UUID库生成UUID；在Python中，可以使用uuid标准库生成UUID。
- 分布式ID生成器：可以使用专门设计的分布式ID生成器来生成唯一的ID。这些ID生成器通常使用一种算法来确保在不同节点上生成的ID不会发生冲突。例如，Twitter的Snow9lake是一个分布式ID生成器，它使用64位整数作为ID，并将时间戳、工作节点ID和序列号组合在一起以确保唯一性。
- 分布式数据库：可以使用分布式数据库（如GoogleCloud Spanner、AmazonDynamoDB或ApacheCassandra等）来生成和存储唯一ID。这些数据库通常提供原子操作和全局一致性保证，以确保在多个节点上生成的ID不会发生冲突。
- 中心化ID生成服务：可以创建一个中心化的ID生成服务，负责为分布式系统中的所有节点生成唯一的ID。这种方法的缺点是它可能成为单点故障（single point of failure）和性能瓶颈。为了解决这些问题，可以使用负载均衡和故障转移技术，以确保ID生成服务的可用性和可扩展性。

## 常用的负载均衡策略?

常用的负载均衡策略主要分为静态负载均衡，动态负载均衡，混合策略3种：
**静态负载均衡**策略：

- 轮询：按顺序将请求依次分配给后端服务器，循环分配
- 加权轮询：根据服务器性能预设权重，权重高的服务器分配更多请求
- IP哈希：根据客户端IP计算哈希值，固定分配到同一服务器

**动态负载均衡**策略：

- 最少连接数：优先将请求分配给当前连接数最少的服务器
- 最短响应时间：综合服务器响应时间和连接数，选择响应最快的节点
- 基于资源：根据CPU、内存使用率等资源指标分配请求

高级策略:

- 一致性哈希：将服务器和请求映射到哈希环，增减节点时仅影响邻近请求
- 预测性负载均衡：利用历史数据和机器学习预测流量趋势，提前调整资源
